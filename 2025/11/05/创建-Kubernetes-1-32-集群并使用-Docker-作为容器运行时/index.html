

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/Yaney.jpg">
  <link rel="icon" href="/img/lizi.svg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Yaney">
  <meta name="keywords" content="">
  
    <meta name="description" content="æœ¬æ–‡ä»‹ç»äº†ä½¿ç”¨ kubeadm æ­å»ºåŸºäº Docker è¿è¡Œæ—¶ çš„ Kubernetes é›†ç¾¤ï¼Œé‡ç‚¹æ¼”ç¤ºäº†åœ¨ dockershim è¢«ç§»é™¤åï¼Œå¦‚ä½•é€šè¿‡ cri-dockerd é‡æ–°é›†æˆ Dockerã€‚å†…å®¹æ¶µç›–ç¯å¢ƒå‡†å¤‡ã€ç»„ä»¶å®‰è£…ã€é›†ç¾¤åˆå§‹åŒ–åŠ Flannel ç½‘ç»œéƒ¨ç½²ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="åˆ›å»º Kubernetes 1.32+ é›†ç¾¤å¹¶ä½¿ç”¨ Docker ä½œä¸ºå®¹å™¨è¿è¡Œæ—¶">
<meta property="og:url" content="http://example.com/2025/11/05/%E5%88%9B%E5%BB%BA-Kubernetes-1-32-%E9%9B%86%E7%BE%A4%E5%B9%B6%E4%BD%BF%E7%94%A8-Docker-%E4%BD%9C%E4%B8%BA%E5%AE%B9%E5%99%A8%E8%BF%90%E8%A1%8C%E6%97%B6/index.html">
<meta property="og:site_name" content="Yaney&#39;s Blog">
<meta property="og:description" content="æœ¬æ–‡ä»‹ç»äº†ä½¿ç”¨ kubeadm æ­å»ºåŸºäº Docker è¿è¡Œæ—¶ çš„ Kubernetes é›†ç¾¤ï¼Œé‡ç‚¹æ¼”ç¤ºäº†åœ¨ dockershim è¢«ç§»é™¤åï¼Œå¦‚ä½•é€šè¿‡ cri-dockerd é‡æ–°é›†æˆ Dockerã€‚å†…å®¹æ¶µç›–ç¯å¢ƒå‡†å¤‡ã€ç»„ä»¶å®‰è£…ã€é›†ç¾¤åˆå§‹åŒ–åŠ Flannel ç½‘ç»œéƒ¨ç½²ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/image/how-to-install-and-configure-kubernetes-on-ubuntu-22-04-update.png">
<meta property="article:published_time" content="2025-11-05T14:18:45.000Z">
<meta property="article:modified_time" content="2025-11-05T14:39:05.012Z">
<meta property="article:author" content="Yaney">
<meta property="article:tag" content="Kubernetes å®‰å…¨">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/image/how-to-install-and-configure-kubernetes-on-ubuntu-22-04-update.png">
  
  
  
  <title>åˆ›å»º Kubernetes 1.32+ é›†ç¾¤å¹¶ä½¿ç”¨ Docker ä½œä¸ºå®¹å™¨è¿è¡Œæ—¶ - Yaney&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"Bash"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":6},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  



  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Yaney&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/image/how-to-install-and-configure-kubernetes-on-ubuntu-22-04-update.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="åˆ›å»º Kubernetes 1.32+ é›†ç¾¤å¹¶ä½¿ç”¨ Docker ä½œä¸ºå®¹å™¨è¿è¡Œæ—¶"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-11-05 22:18" pubdate>
          2025å¹´11æœˆ5æ—¥ æ™šä¸Š
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.5k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          21 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">åˆ›å»º Kubernetes 1.32+ é›†ç¾¤å¹¶ä½¿ç”¨ Docker ä½œä¸ºå®¹å™¨è¿è¡Œæ—¶</h1>
            
              <p id="updated-time" class="note note-info" style="">
                
                  
                    æœ¬æ–‡æœ€åæ›´æ–°äº 2025å¹´11æœˆ5æ—¥ æ™šä¸Š
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>æœ¬æ–‡ä»‹ç»äº†ä½¿ç”¨ kubeadm æ­å»ºåŸºäº Docker è¿è¡Œæ—¶ çš„ Kubernetes é›†ç¾¤ï¼Œé‡ç‚¹æ¼”ç¤ºäº†åœ¨ dockershim è¢«ç§»é™¤åï¼Œå¦‚ä½•é€šè¿‡ cri-dockerd é‡æ–°é›†æˆ Dockerã€‚å†…å®¹æ¶µç›–ç¯å¢ƒå‡†å¤‡ã€ç»„ä»¶å®‰è£…ã€é›†ç¾¤åˆå§‹åŒ–åŠ Flannel ç½‘ç»œéƒ¨ç½²ï¼Œå¸®åŠ©è¯»è€…å¿«é€ŸæŒæ¡ Docker åœ¨æ–°ç‰ˆ Kubernetes ä¸­çš„é€‚é…æ–¹æ³•ã€‚</p>
<h2 id="0x01-ç¯å¢ƒ"><a href="#0x01-ç¯å¢ƒ" class="headerlink" title="0x01 ç¯å¢ƒ"></a>0x01 ç¯å¢ƒ</h2><p><img src="/image/image_bwK44c-vlh.png" srcset="/img/loading.gif" lazyload alt="å›¾ 1ï¼šå®éªŒç¯å¢ƒ" title="å›¾ 1ï¼šå®éªŒç¯å¢ƒ"></p>
<table>
<thead>
<tr>
<th>æ“ä½œç³»ç»Ÿ</th>
<th>IP åœ°å€</th>
<th>è§’è‰²</th>
</tr>
</thead>
<tbody><tr>
<td>Ubuntu 22.04</td>
<td>172.16.9.138</td>
<td>æ§åˆ¶å¹³é¢</td>
</tr>
<tr>
<td>Kali 2025.3</td>
<td>172.16.9.139</td>
<td>å·¥ä½œèŠ‚ç‚¹</td>
</tr>
</tbody></table>
<h2 id="0x02-å…ˆå†³æ¡ä»¶"><a href="#0x02-å…ˆå†³æ¡ä»¶" class="headerlink" title="0x02 å…ˆå†³æ¡ä»¶"></a>0x02 å…ˆå†³æ¡ä»¶</h2><p>è¯¥å‘½ä»¤å°†æ˜¾ç¤ºç³»ç»Ÿå†…å­˜ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬äº¤æ¢ç©ºé—´çš„ä¿¡æ¯ã€‚å¦‚æœç³»ç»Ÿå¯ç”¨äº†äº¤æ¢ç©ºé—´ï¼Œè¾“å‡ºä¸­å°†æ˜¾ç¤ºäº¤æ¢è¡Œï¼Œå…¶ä¸­åŒ…æ‹¬æ€»äº¤æ¢ç©ºé—´ã€å·²ç”¨äº¤æ¢ç©ºé—´å’Œå¯ç”¨äº¤æ¢ç©ºé—´ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">free -h<br></code></pre></td></tr></table></figure>

<h3 id="2-1-ç¦ç”¨äº¤æ¢ç©ºé—´"><a href="#2-1-ç¦ç”¨äº¤æ¢ç©ºé—´" class="headerlink" title="2.1 ç¦ç”¨äº¤æ¢ç©ºé—´"></a>2.1 ç¦ç”¨äº¤æ¢ç©ºé—´</h3><p>Kubernetes ä¸æ”¯æŒå¯ç”¨ swapï¼ˆäº¤æ¢ç©ºé—´ï¼‰ï¼Œä½ æœ‰ä¸¤ç§è§£å†³æ–¹æ³•ã€‚æ¨èçš„åšæ³•æ˜¯ç¦ç”¨ swapï¼Œå› ä¸ºè¿™ç¬¦åˆ Kubernetes çš„æœ€ä½³å®è·µã€‚å¦‚æœä½ å¸Œæœ›ç»§ç»­ä½¿ç”¨ swapï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ Kubelet çš„å¯åŠ¨å‚æ•°æ¥é¿å…è¿™ä¸ªé”™è¯¯ã€‚</p>
<h4 id="2-1-1-ç¦ç”¨-swap"><a href="#2-1-1-ç¦ç”¨-swap" class="headerlink" title="2.1.1: ç¦ç”¨ swap"></a>2.1.1: ç¦ç”¨ swap</h4><p>æœ€å¸¸è§çš„è§£å†³æ–¹æ³•æ˜¯ç¦ç”¨ç³»ç»Ÿçš„ swapã€‚ä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼š</p>
<ol>
<li><p><strong>ä¸´æ—¶ç¦ç”¨ swap</strong>ï¼ˆç›´åˆ°ç³»ç»Ÿé‡å¯ï¼‰</p>
<p>è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥ä¸´æ—¶ç¦ç”¨ swapï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> swapoff -a<br></code></pre></td></tr></table></figure>

<p>è¯¥å‘½ä»¤å°†ç¦ç”¨æ‰€æœ‰äº¤æ¢ç©ºé—´ï¼Œç›´è‡³ä¸‹æ¬¡ç³»ç»Ÿé‡å¯ã€‚</p>
</li>
<li><p><strong>æ°¸ä¹…ç¦ç”¨ swap</strong>ï¼ˆç³»ç»Ÿé‡å¯åä»ç„¶ç¦ç”¨ï¼‰</p>
<p>è‹¥è¦æ°¸ä¹…ç¦ç”¨ swapï¼Œéœ€è¦ä¿®æ”¹ <code>/etc/fstab</code> æ–‡ä»¶ï¼Œåˆ é™¤æˆ–æ³¨é‡Šæ‰æ¶‰åŠ swap çš„è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> nano /etc/fstab<br></code></pre></td></tr></table></figure>

<p>æ‰¾åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„è¡Œï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/swapfile none swap sw 0 0<br></code></pre></td></tr></table></figure>

<p>åˆ é™¤è¯¥è¡Œæˆ–åœ¨è¡Œå‰åŠ  <code>#</code> ä»¥æ³¨é‡Šæ‰ï¼Œç„¶åä¿å­˜æ–‡ä»¶å¹¶é€€å‡ºç¼–è¾‘å™¨ã€‚</p>
</li>
</ol>
<h4 id="2-1-2-è®¾ç½®-fail-swap-on-false-é€‰é¡¹"><a href="#2-1-2-è®¾ç½®-fail-swap-on-false-é€‰é¡¹" class="headerlink" title="2.1.2 è®¾ç½® --fail-swap-on=false é€‰é¡¹"></a>2.1.2 è®¾ç½® <code>--fail-swap-on=false</code> é€‰é¡¹</h4><p>å¦‚æœä½ ä¸å¸Œæœ›ç¦ç”¨ swapï¼Œå¯ä»¥é€‰æ‹©å°† <code>--fail-swap-on</code> å‚æ•°è®¾ç½®ä¸º <code>false</code>ï¼Œè¿™æ ·å³ä½¿ swap è¢«å¯ç”¨ï¼ŒKubelet ä¹Ÿä¸ä¼šå› æ­¤å¤±è´¥ã€‚</p>
<ol>
<li><p>æ‰¾åˆ° Kubelet çš„å¯åŠ¨é…ç½®æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ <code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code> æˆ– <code>/etc/kubernetes/kubelet.conf</code>ã€‚æ–‡ä»¶è·¯å¾„å¯èƒ½å› å®‰è£…æ–¹æ³•è€Œå¼‚ã€‚</p>
</li>
<li><p>ç¼–è¾‘è¯¥æ–‡ä»¶ï¼Œæ·»åŠ  <code>--fail-swap-on=false</code> é€‰é¡¹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> nano /etc/systemd/system/kubelet.service.d/10-kubeadm.conf<br></code></pre></td></tr></table></figure>

<p>åœ¨ <code>ExecStart</code> è¡Œä¸­åŠ å…¥ <code>--fail-swap-on=false</code>ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ExecStart=/usr/bin/kubelet --fail-swap-on=<span class="hljs-literal">false</span> ...<br></code></pre></td></tr></table></figure>
</li>
<li><p>ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨ï¼Œç„¶åé‡æ–°åŠ è½½ systemd é…ç½®å¹¶é‡å¯ Kubeletï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl daemon-reload<br><span class="hljs-built_in">sudo</span> systemctl restart kubelet<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="0x03-å®‰è£…-Docker-Engine"><a href="#0x03-å®‰è£…-Docker-Engine" class="headerlink" title="0x03 å®‰è£… Docker Engine"></a>0x03 å®‰è£… Docker Engine</h2><p>ä¸ºäº†ä¾¿äº Docker Engine çš„å®‰è£…ä¸ç®¡ç†ï¼Œå»ºè®®é€šè¿‡ <code>apt</code> æ–¹å¼è¿›è¡Œå®‰è£…ã€‚</p>
<ol>
<li><p>åœ¨æ–°çš„è™šæ‹Ÿæœºä¸Šé¦–æ¬¡å®‰è£… Docker Engine ä¹‹å‰ï¼Œéœ€è¦æ·»åŠ  Docker ä»“åº“ï¼Œä»¥ä¾¿å®‰è£…å’Œæ›´æ–° Docker Engineã€‚å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ Ubuntu è¡ç”Ÿå‘è¡Œç‰ˆï¼ˆå¦‚ Linux Mintï¼‰ï¼Œåˆ™å¯èƒ½éœ€è¦ä½¿ç”¨ <code>UBUNTU_CODENAME</code> è€Œä¸æ˜¯ <code>VERSION_CODENAME</code>ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># æ·»åŠ  Docker çš„ å®˜æ–¹ GPG å¯†é’¥ï¼š</span><br><span class="hljs-built_in">sudo</span> apt-get update<br><span class="hljs-built_in">sudo</span> apt-get install ca-certificates curl<br><span class="hljs-built_in">sudo</span> install -m 0755 -d /etc/apt/keyrings<br><span class="hljs-built_in">sudo</span> curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chmod</span> a+r /etc/apt/keyrings/docker.asc<br><br><span class="hljs-comment"># å°†ä»“åº“æ·»åŠ åˆ° apt æºä¸­</span><br><span class="hljs-built_in">echo</span> \<br>  <span class="hljs-string">&quot;deb [arch=<span class="hljs-subst">$(dpkg --print-architecture)</span> signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \</span><br><span class="hljs-string">  <span class="hljs-subst">$(. /etc/os-release &amp;&amp; echo <span class="hljs-string">&quot;<span class="hljs-variable">$VERSION_CODENAME</span>&quot;</span>)</span> stable&quot;</span> | \<br>  <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null<br><span class="hljs-built_in">sudo</span> apt-get update<br></code></pre></td></tr></table></figure>

<p>ç”±äº Kali Linux æ˜¯ Debian çš„è¡ç”Ÿå‘è¡Œç‰ˆï¼Œåœ¨å®‰è£…å·¥ä½œèŠ‚ç‚¹æ—¶ï¼Œéœ€è¦ç”¨ç›¸åº”çš„ Debian ç‰ˆæœ¬ä»£å·æ¥æ›¿æ¢å‘½ä»¤ä¸­ç”¨äºæ‰“å°ç‰ˆæœ¬ä»£å·çš„éƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œå°† <code>(. /etc/os-release &amp;&amp; echo &quot;$VERSION_CODENAME&quot;)</code>æ›¿æ¢ä¸º <code>trixie</code>ã€‚</p>
</li>
</ol>
<p><img src="/image/image_eORBiVrGty.png" srcset="/img/loading.gif" lazyload alt="å›¾ 2ï¼šç»™ Kali Linux æ·»åŠ  Docker Engine çš„ apt ä»“åº“æº" title="å›¾2ï¼šç»™ Kali Linux æ·»åŠ  Docker Engine çš„ apt ä»“åº“æº"><br>2. å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Docker è½¯ä»¶åŒ…ã€‚</p>
   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin<br><br></code></pre></td></tr></table></figure>

<ol start="3">
<li><p>é€šè¿‡è¿è¡Œ hello-world é•œåƒæ¥éªŒè¯ Docker Engine æ˜¯å¦å®‰è£…æˆåŠŸã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> docker run hello-world<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="0x04-å®‰è£…-kubeadm"><a href="#0x04-å®‰è£…-kubeadm" class="headerlink" title="0x04 å®‰è£… kubeadm"></a>0x04 å®‰è£… kubeadm</h2><p>ä¸ºäº†ä¾¿äº kubeadm çš„å®‰è£…å’Œç®¡ç†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ kubeadm è¿›è¡Œæ“ä½œã€‚</p>
<ol>
<li><p>æ›´æ–° apt è½¯ä»¶åŒ…ç´¢å¼•å¹¶å®‰è£… Kubernetes apt ä»“åº“æ‰€éœ€çš„è½¯ä»¶åŒ…ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt-get update<br><span class="hljs-built_in">sudo</span> apt-get install -y apt-transport-https ca-certificates curl gpg<br></code></pre></td></tr></table></figure>
</li>
<li><p>ä¸‹è½½ Kubernetes è½¯ä»¶åŒ…ä»“åº“çš„å…¬å…±ç­¾åå¯†é’¥ã€‚æ‰€æœ‰ä»“åº“éƒ½ä½¿ç”¨ç›¸åŒçš„ç­¾åå¯†é’¥ï¼Œå› æ­¤å¯ä»¥å¿½ç•¥ URL ä¸­çš„ç‰ˆæœ¬å·ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># å¦‚æœç›®å½• /etc/apt/keyrings ä¸å­˜åœ¨ï¼Œéœ€è¦å…ˆåˆ›å»º</span><br><span class="hljs-comment"># sudo mkdir -p -m 755 /etc/apt/keyrings</span><br><br>curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.32/deb/Release.key | <span class="hljs-built_in">sudo</span> gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ·»åŠ é€‚å½“çš„ Kubernetes apt ä»“åº“ã€‚è¯·æ³¨æ„ï¼Œæ­¤ä»“åº“ä»…åŒ…å«é€‚ç”¨äº Kubernetes 1.32 çš„è½¯ä»¶åŒ…ï¼›å¯¹äºå…¶ä»–æ¬¡è¦ç‰ˆæœ¬ï¼Œè¯·æ›´æ”¹ URL ä¸­çš„ç‰ˆæœ¬å·ï¼Œå¹¶å‚è€ƒç›¸åº”ç‰ˆæœ¬çš„å®˜æ–¹å®‰è£…æŒ‡å—ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.32/deb/ /&#x27;</span> | <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/kubernetes.list<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ›´æ–° apt è½¯ä»¶åŒ…ç´¢å¼•ï¼Œå®‰è£… kubeletã€kubeadm å’Œ kubectlï¼Œå¹¶é”å®šå®ƒä»¬çš„ç‰ˆæœ¬ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt-get update<br><span class="hljs-built_in">sudo</span> apt-get install -y kubelet kubeadm kubectl<br><span class="hljs-built_in">sudo</span> apt-mark hold kubelet kubeadm kubectl<br></code></pre></td></tr></table></figure>
</li>
<li><p>ï¼ˆå¯é€‰ï¼‰åœ¨è¿è¡Œ kubeadm ä¹‹å‰å¯ç”¨ kubelet æœåŠ¡ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> systemctl <span class="hljs-built_in">enable</span> --now kubelet<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="0x05-å®‰è£…-Dockershim"><a href="#0x05-å®‰è£…-Dockershim" class="headerlink" title="0x05 å®‰è£… Dockershim"></a>0x05 å®‰è£… Dockershim</h2><p>éšç€æ—¶é—´çš„æ¨ç§»ï¼ŒKubernetes åˆ›å»ºäº† CRI æ¥å£ï¼Œå…è®¸ç”¨æˆ·æ¥å…¥ä¸åŒçš„è¿è¡Œæ—¶ç¯å¢ƒï¼Œä»è€Œä½¿ Kubernetes é€æ¸æ¼”å˜æˆä¸€ä¸ªä¸å®¹å™¨æ— å…³çš„å¹³å°ã€‚</p>
<p>Docker Engine æ˜¯ä¸€ä¸ªæ¯” Kubernetes æ›´æ—©çš„é¡¹ç›®ï¼Œå¹¶æœªå®ç° CRIã€‚ä¸ºäº†å¼¥åˆæ–°æ—§æŠ€æœ¯ä¹‹é—´çš„å·®è·ï¼ŒKubernetes å¼•å…¥äº†ä¸€ä¸ªåä¸º dockershim çš„ç»„ä»¶ï¼Œä½¿ Kubernetes èƒ½å¤Ÿä½¿ç”¨ Docker ä½œä¸ºè¿è¡Œæ—¶æ¥æ‰§è¡Œå®¹å™¨ã€‚ç„¶è€Œï¼Œä» Kubernetes 1.24 ç‰ˆæœ¬å¼€å§‹ï¼Œdockershim ç»„ä»¶è¢«å®Œå…¨ç§»é™¤ï¼Œå› æ­¤ Kubernetes ä¸å†åŸç”Ÿæ”¯æŒ Docker ä½œä¸ºè¿è¡Œæ—¶ã€‚</p>
<p><img src="/image/image_yC5tnvVo7S.png" srcset="/img/loading.gif" lazyload alt="å›¾ 3ï¼šæ—©æœŸçš„ Kubernetes é€šè¿‡ dockershim ä½¿ç”¨ dockerï¼Œå¦‚ä»Šå·²å®Œå…¨ç§»é™¤ dockershim äº†" title="å›¾ 3ï¼šæ—©æœŸçš„Kubernetesé€šè¿‡ dockershim ä½¿ç”¨ dockerï¼Œå¦‚ä»Šå·²å®Œå…¨ç§»é™¤dockershimäº†"></p>
<blockquote>
<p>ğŸš¦ è‹¥è¦äº†è§£æ›´å¤šå…³äºå®¹å™¨è¿è¡Œæ—¶çš„çŸ¥è¯†ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬çš„æ–‡ç« <a href="../../../../public/2024/07/09/%E5%B0%8F%E7%8C%AB%E5%92%AA%E5%B8%A6%E4%BD%A0%E7%90%86%E6%B8%85Docker%E3%80%81containerd%E3%80%81CRI-O-%E5%92%8C-runc-%E4%B9%8B%E9%97%B4%E7%9A%84%E5%8C%BA%E5%88%AB/index.html" title="å°çŒ«å’ªå¸¦ä½ ç†æ¸…Dockerã€containerdã€CRI-O å’Œ runc ä¹‹é—´çš„åŒºåˆ«">å°çŒ«å’ªå¸¦ä½ ç†æ¸… Dockerã€containerdã€CRI-O å’Œ runc ä¹‹é—´çš„åŒºåˆ«</a></p>
</blockquote>
<p>ç›®å‰ï¼ŒMirantis ä»åœ¨ç»´æŠ¤ Dockershimï¼Œæˆ‘ä»¬åªéœ€å‰å¾€å…¶ GitHub ä»“åº“ä¸‹è½½ <a target="_blank" rel="noopener" href="https://github.com/Mirantis/cri-dockerd/releases" title="cri-dockerd">cri-dockerd</a> å³å¯ã€‚</p>
<p><img src="/image/image_dV6RKBg_1k.png" srcset="/img/loading.gif" lazyload alt="å›¾ 4ï¼šcir-dockerd çš„ GitHub ä»“åº“" title="å›¾ 4ï¼šcir-dockerd çš„GitHub ä»“åº“"></p>
<ol>
<li><p>ç”±äºæˆ‘çš„ç”µè„‘æ˜¯ MAC M1ï¼Œå› æ­¤æˆ‘ä¸‹è½½äº† ARM64 æ¶æ„çš„ cri-dockerdã€‚æ‚¨éœ€è¦æ ¹æ®å®é™…æƒ…å†µæ›´æ”¹ URL ä¸­çš„æ¶æ„ä¿¡æ¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://github.com/Mirantis/cri-dockerd/releases/download/v0.3.15/cri-dockerd-0.3.15.arm64.tgz<br>tar -xvf cri-dockerd-0.3.15.arm64.tgz<br><span class="hljs-built_in">cd</span> cri-dockerd/<br><span class="hljs-built_in">mkdir</span> -p /usr/local/bin<br>install -o root -g root -m 0755 ./cri-dockerd /usr/local/bin/cri-dockerd<br></code></pre></td></tr></table></figure>
</li>
<li><p>æ·»åŠ  cri-docker.socket å’Œ cri-docker.service æ–‡ä»¶ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">tee</span> /etc/systemd/system/cri-docker.service &lt;&lt; <span class="hljs-string">EOF</span><br><span class="hljs-string">[Unit]</span><br><span class="hljs-string">Description=CRI Interface for Docker Application Container Engine</span><br><span class="hljs-string">Documentation=https://docs.mirantis.com</span><br><span class="hljs-string">After=network-online.target firewalld.service docker.service</span><br><span class="hljs-string">Wants=network-online.target</span><br><span class="hljs-string">Requires=cri-docker.socket</span><br><span class="hljs-string">[Service]</span><br><span class="hljs-string">Type=notify</span><br><span class="hljs-string">ExecStart=/usr/local/bin/cri-dockerd --container-runtime-endpoint fd:// --network-plugin=</span><br><span class="hljs-string">ExecReload=/bin/kill -s HUP $MAINPID</span><br><span class="hljs-string">TimeoutSec=0</span><br><span class="hljs-string">RestartSec=2</span><br><span class="hljs-string">Restart=always</span><br><span class="hljs-string">StartLimitBurst=3</span><br><span class="hljs-string">StartLimitInterval=60s</span><br><span class="hljs-string">LimitNOFILE=infinity</span><br><span class="hljs-string">LimitNPROC=infinity</span><br><span class="hljs-string">LimitCORE=infinity</span><br><span class="hljs-string">TasksMax=infinity</span><br><span class="hljs-string">Delegate=yes</span><br><span class="hljs-string">KillMode=process</span><br><span class="hljs-string">[Install]</span><br><span class="hljs-string">WantedBy=multi-user.target</span><br><span class="hljs-string">EOF</span><br><br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">tee</span> /etc/systemd/system/cri-docker.socket &lt;&lt; <span class="hljs-string">EOF</span><br><span class="hljs-string">[Unit]</span><br><span class="hljs-string">Description=CRI Docker Socket for the API</span><br><span class="hljs-string">PartOf=cri-docker.service</span><br><span class="hljs-string">[Socket]</span><br><span class="hljs-string">ListenStream=%t/cri-dockerd.sock</span><br><span class="hljs-string">SocketMode=0660</span><br><span class="hljs-string">SocketUser=root</span><br><span class="hljs-string">SocketGroup=docker</span><br><span class="hljs-string">[Install]</span><br><span class="hljs-string">WantedBy=sockets.target</span><br><span class="hljs-string">EOF</span><br><br></code></pre></td></tr></table></figure>
</li>
<li><p>é…ç½®å’Œç®¡ç† Kubernetes ç¯å¢ƒä¸­çš„ cri-docker æœåŠ¡ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># é‡è½½å®ˆæŠ¤è¿›ç¨‹</span><br>systemctl daemon-reload<br>systemctl <span class="hljs-built_in">enable</span> cri-docker.service<br>systemctl <span class="hljs-built_in">enable</span> --now cri-docker.socket<br><br><span class="hljs-comment"># è®¾ç½®æ‰€éœ€çš„ sysctl å‚æ•°ï¼Œè¿™äº›å‚æ•°ä¼šåœ¨é‡å¯æ—¶æŒç»­å­˜åœ¨ã€‚</span><br><span class="hljs-built_in">cat</span> &lt;&lt;<span class="hljs-string">EOF | sudo tee /etc/sysctl.d/99-kubernetes-cri.conf</span><br><span class="hljs-string">net.bridge.bridge-nf-call-iptables  = 1</span><br><span class="hljs-string">net.ipv4.ip_forward                 = 1</span><br><span class="hljs-string">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="hljs-string">EOF</span><br><br><span class="hljs-comment"># æ— éœ€é‡å¯å³å¯åº”ç”¨ sysctl å‚æ•°</span><br><span class="hljs-built_in">sudo</span> sysctl --system<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="0x06-åˆå§‹åŒ–é›†ç¾¤"><a href="#0x06-åˆå§‹åŒ–é›†ç¾¤" class="headerlink" title="0x06 åˆå§‹åŒ–é›†ç¾¤"></a>0x06 åˆå§‹åŒ–é›†ç¾¤</h2><ol>
<li><p>ç”±äºéœ€è¦æ‹‰å–çš„é•œåƒä½“ç§¯è¾ƒå¤§ä¸”æ•°é‡è¾ƒå¤šï¼Œä¸ºäº†é¿å…åœ¨åˆå§‹åŒ–é›†ç¾¤æ—¶å› ç½‘ç»œé—®é¢˜å¯¼è‡´æ— æ³•æˆåŠŸæ‹‰å–é•œåƒï¼Œæˆ‘ä»¬å¯ä»¥æå‰è¿›è¡Œé•œåƒæ‹‰å–ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> kubeadm config images pull \<br>--cri-socket unix:///var/run/cri-dockerd.sock \<br>--kubernetes-version v1.32.0<br><br></code></pre></td></tr></table></figure>

<p><img src="/image/image_reKz2BG0y5.png" srcset="/img/loading.gif" lazyload alt="å›¾ 5ï¼šéœ€è¦æ‹‰å–çš„é•œåƒ" title="å›¾5ï¼šéœ€è¦æ‹‰å–çš„é•œåƒ"></p>
</li>
<li><p>è¿™é‡Œçš„ pod ç½‘ç»œ CIDR ä¾èµ–äºç¨åè¦å®‰è£…çš„ CNIï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯ Flannelã€‚<code>--apiserver-advertise-address</code>æ˜¯æ§åˆ¶å¹³é¢èŠ‚ç‚¹çš„ IP åœ°å€ï¼Œå¯ä»¥æ˜¯ç§æœ‰ IP æˆ–å…¬å…± IPã€‚å¦‚æœæ‚¨å¸Œæœ›é€šè¿‡ kubeconfig ä»é›†ç¾¤å¤–éƒ¨è®¿é—®ï¼Œåˆ™éœ€è¦æä¾›å…¬å…± IPã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> kubeadm init   \<br>--pod-network-cidr=10.244.0.0/16   \<br>--upload-certs --kubernetes-version=v1.32.0   \<br>--control-plane-endpoint=172.16.9.138   \<br>--cri-socket unix:///var/run/cri-dockerd.sock<br><br><br></code></pre></td></tr></table></figure>

<p>è¿™æ¡å‘½ä»¤ä¼šè¾“å‡ºä»¥ä¸‹ä¿¡æ¯ï¼Œéœ€è¦å¦¥å–„ä¿å­˜ã€‚å¦‚æœå°†æ¥æœ‰æ–°çš„èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ï¼Œè¿™äº›ä¿¡æ¯å¯ä»¥ä½œä¸ºå‚è€ƒã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs bash">[init] Using Kubernetes version: v1.32.0<br>[preflight] Running pre-flight checks<br>[preflight] Pulling images required <span class="hljs-keyword">for</span> setting up a Kubernetes cluster<br>[preflight] This might take a minute or two, depending on the speed of your internet connection<br>[preflight] You can also perform this action <span class="hljs-keyword">in</span> beforehand using <span class="hljs-string">&#x27;kubeadm config images pull&#x27;</span><br>[certs] Using certificateDir folder <span class="hljs-string">&quot;/etc/kubernetes/pki&quot;</span><br>[certs] Generating <span class="hljs-string">&quot;ca&quot;</span> certificate and key<br>[certs] Generating <span class="hljs-string">&quot;apiserver&quot;</span> certificate and key<br>[certs] apiserver serving cert is signed <span class="hljs-keyword">for</span> DNS names [kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local ubuntu] and IPs [10.96.0.1 172.16.9.138]<br>[certs] Generating <span class="hljs-string">&quot;apiserver-kubelet-client&quot;</span> certificate and key<br>[certs] Generating <span class="hljs-string">&quot;front-proxy-ca&quot;</span> certificate and key<br>[certs] Generating <span class="hljs-string">&quot;front-proxy-client&quot;</span> certificate and key<br>[certs] Generating <span class="hljs-string">&quot;etcd/ca&quot;</span> certificate and key<br>[certs] Generating <span class="hljs-string">&quot;etcd/server&quot;</span> certificate and key<br>[certs] etcd/server serving cert is signed <span class="hljs-keyword">for</span> DNS names [localhost ubuntu] and IPs [172.16.9.138 127.0.0.1 ::1]<br>[certs] Generating <span class="hljs-string">&quot;etcd/peer&quot;</span> certificate and key<br>[certs] etcd/peer serving cert is signed <span class="hljs-keyword">for</span> DNS names [localhost ubuntu] and IPs [172.16.9.138 127.0.0.1 ::1]<br>[certs] Generating <span class="hljs-string">&quot;etcd/healthcheck-client&quot;</span> certificate and key<br>[certs] Generating <span class="hljs-string">&quot;apiserver-etcd-client&quot;</span> certificate and key<br>[certs] Generating <span class="hljs-string">&quot;sa&quot;</span> key and public key<br>[kubeconfig] Using kubeconfig folder <span class="hljs-string">&quot;/etc/kubernetes&quot;</span><br>[kubeconfig] Writing <span class="hljs-string">&quot;admin.conf&quot;</span> kubeconfig file<br>[kubeconfig] Writing <span class="hljs-string">&quot;kubelet.conf&quot;</span> kubeconfig file<br>[kubeconfig] Writing <span class="hljs-string">&quot;controller-manager.conf&quot;</span> kubeconfig file<br>[kubeconfig] Writing <span class="hljs-string">&quot;scheduler.conf&quot;</span> kubeconfig file<br>[kubelet-start] Writing kubelet environment file with flags to file <span class="hljs-string">&quot;/var/lib/kubelet/kubeadm-flags.env&quot;</span><br>[kubelet-start] Writing kubelet configuration to file <span class="hljs-string">&quot;/var/lib/kubelet/config.yaml&quot;</span><br>[kubelet-start] Starting the kubelet<br>[control-plane] Using manifest folder <span class="hljs-string">&quot;/etc/kubernetes/manifests&quot;</span><br>[control-plane] Creating static Pod manifest <span class="hljs-keyword">for</span> <span class="hljs-string">&quot;kube-apiserver&quot;</span><br>[control-plane] Creating static Pod manifest <span class="hljs-keyword">for</span> <span class="hljs-string">&quot;kube-controller-manager&quot;</span><br>[control-plane] Creating static Pod manifest <span class="hljs-keyword">for</span> <span class="hljs-string">&quot;kube-scheduler&quot;</span><br>[etcd] Creating static Pod manifest <span class="hljs-keyword">for</span> <span class="hljs-built_in">local</span> etcd <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;/etc/kubernetes/manifests&quot;</span><br>[wait-control-plane] Waiting <span class="hljs-keyword">for</span> the kubelet to boot up the control plane as static Pods from directory <span class="hljs-string">&quot;/etc/kubernetes/manifests&quot;</span>. This can take up to 4m0s<br>[apiclient] All control plane components are healthy after 22.501345 seconds<br>[upload-config] Storing the configuration used <span class="hljs-keyword">in</span> ConfigMap <span class="hljs-string">&quot;kubeadm-config&quot;</span> <span class="hljs-keyword">in</span> the <span class="hljs-string">&quot;kube-system&quot;</span> Namespace<br>[kubelet] Creating a ConfigMap <span class="hljs-string">&quot;kubelet-config&quot;</span> <span class="hljs-keyword">in</span> namespace kube-system with the configuration <span class="hljs-keyword">for</span> the kubelets <span class="hljs-keyword">in</span> the cluster<br>[upload-certs] Storing the certificates <span class="hljs-keyword">in</span> Secret <span class="hljs-string">&quot;kubeadm-certs&quot;</span> <span class="hljs-keyword">in</span> the <span class="hljs-string">&quot;kube-system&quot;</span> Namespace<br>[upload-certs] Using certificate key:<br>fdf05142753d40079d55cd5cf8ee1ae98a9a0c21cff77cb32cefbab87db97ebc<br>[mark-control-plane] Marking the node ubuntu as control-plane by adding the labels: [node-role.kubernetes.io/control-plane node.kubernetes.io/exclude-from-external-load-balancers]<br>[mark-control-plane] Marking the node ubuntu as control-plane by adding the taints [node-role.kubernetes.io/control-plane:NoSchedule]<br>[bootstrap-token] Using token: zwwasu.94c2jn07znyumkkq<br>[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles<br>[bootstrap-token] Configured RBAC rules to allow Node Bootstrap tokens to get nodes<br>[bootstrap-token] Configured RBAC rules to allow Node Bootstrap tokens to post CSRs <span class="hljs-keyword">in</span> order <span class="hljs-keyword">for</span> nodes to get long term certificate credentials<br>[bootstrap-token] Configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token<br>[bootstrap-token] Configured RBAC rules to allow certificate rotation <span class="hljs-keyword">for</span> all node client certificates <span class="hljs-keyword">in</span> the cluster<br>[bootstrap-token] Creating the <span class="hljs-string">&quot;cluster-info&quot;</span> ConfigMap <span class="hljs-keyword">in</span> the <span class="hljs-string">&quot;kube-public&quot;</span> namespace<br>[kubelet-finalize] Updating <span class="hljs-string">&quot;/etc/kubernetes/kubelet.conf&quot;</span> to point to a rotatable kubelet client certificate and key<br>[addons] Applied essential addon: CoreDNS<br>[addons] Applied essential addon: kube-proxy<br><br>Your Kubernetes control-plane has initialized successfully!<br><br>To start using your cluster, you need to run the following as a regular user:<br><br>  <span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$HOME</span>/.kube<br>  <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">cp</span> -i /etc/kubernetes/admin.conf <span class="hljs-variable">$HOME</span>/.kube/config<br>  <span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chown</span> $(<span class="hljs-built_in">id</span> -u):$(<span class="hljs-built_in">id</span> -g) <span class="hljs-variable">$HOME</span>/.kube/config<br><br>Alternatively, <span class="hljs-keyword">if</span> you are the root user, you can run:<br><br>  <span class="hljs-built_in">export</span> KUBECONFIG=/etc/kubernetes/admin.conf<br><br>You should now deploy a pod network to the cluster.<br>Run <span class="hljs-string">&quot;kubectl apply -f [podnetwork].yaml&quot;</span> with one of the options listed at:<br>  https://kubernetes.io/docs/concepts/cluster-administration/addons/<br><br>You can now <span class="hljs-built_in">join</span> any number of the control-plane node running the following <span class="hljs-built_in">command</span> on each as root:<br><br>  kubeadm <span class="hljs-built_in">join</span> 172.16.9.138:6443 --token zwwasu.94c2jn07znyumkkq \<br>  --discovery-token-ca-cert-hash sha256:be429318cc8309484b4c8a2ed1811cf50747c1f30273af893d0b7724e7bce599 \<br>  --control-plane --certificate-key fdf05142753d40079d55cd5cf8ee1ae98a9a0c21cff77cb32cefbab87db97ebc<br><br>Please note that the certificate-key gives access to cluster sensitive data, keep it secret!<br>As a safeguard, uploaded-certs will be deleted <span class="hljs-keyword">in</span> two hours; If necessary, you can use<br><span class="hljs-string">&quot;kubeadm init phase upload-certs --upload-certs&quot;</span> to reload certs afterward.<br><br>Then you can <span class="hljs-built_in">join</span> any number of worker nodes by running the following on each as root:<br><br>kubeadm <span class="hljs-built_in">join</span> 172.16.9.138:6443 --token zwwasu.94c2jn07znyumkkq \<br>  --discovery-token-ca-cert-hash sha256:be429318cc8309484b4c8a2ed1811cf50747c1f30273af893d0b7724e7bce599<br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="0x07-å®‰è£…-Flannel"><a href="#0x07-å®‰è£…-Flannel" class="headerlink" title="0x07 å®‰è£… Flannel"></a>0x07 å®‰è£… Flannel</h2><p>æ¥ä¸‹æ¥å°±æ˜¯å¯¼å‡º kubeconfig å¹¶å®‰è£… flannel äº†ã€‚</p>
<ol>
<li><p>åˆ›å»º kubeconfig å­˜æ”¾ç›®å½•ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -p <span class="hljs-variable">$HOME</span>/.kube<br></code></pre></td></tr></table></figure>
</li>
<li><p>å¤åˆ¶é›†ç¾¤ç®¡ç†å‘˜é…ç½®æ–‡ä»¶åˆ°å½“å‰ç”¨æˆ·ç›®å½•ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">cp</span> -i /etc/kubernetes/admin.conf <span class="hljs-variable">$HOME</span>/.kube/config<br></code></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶æ‰€æœ‰æƒä¸ºå½“å‰ç”¨æˆ·ï¼Œé¿å…æƒé™é—®é¢˜ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chown</span> $(<span class="hljs-built_in">id</span> -u):$(<span class="hljs-built_in">id</span> -g) <span class="hljs-variable">$HOME</span>/.kube/config<br></code></pre></td></tr></table></figure>
</li>
<li><p>ä¸´æ—¶è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œè®© kubectl èƒ½è®¿é—®é›†ç¾¤ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> KUBECONFIG=/etc/kubernetes/admin.conf<br></code></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨å®˜æ–¹ YAML æ¸…å•éƒ¨ç½² Flannel ç½‘ç»œæ’ä»¶ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">kubectl</span> <span class="hljs-string">apply</span> <span class="hljs-string">-f</span> <span class="hljs-string">https://github.com/coreos/flannel/raw/master/Documentation/kube-flannel.yml</span><br></code></pre></td></tr></table></figure></li>
</ol>
<h2 id="0x08-åŠ å…¥å·¥ä½œèŠ‚ç‚¹"><a href="#0x08-åŠ å…¥å·¥ä½œèŠ‚ç‚¹" class="headerlink" title="0x08 åŠ å…¥å·¥ä½œèŠ‚ç‚¹"></a>0x08 åŠ å…¥å·¥ä½œèŠ‚ç‚¹</h2><ol>
<li><p>å¦‚æœä¹‹å‰çš„ä¿¡æ¯æ²¡æœ‰å¦¥å–„ä¿å­˜ï¼Œä¹Ÿå¯ä»¥åœ¨ master èŠ‚ç‚¹ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kubeadm token create --print-join-command<br></code></pre></td></tr></table></figure>
</li>
<li><p>ä¸Šè¿°å‘½ä»¤å°†è¾“å‡ºç±»ä¼¼ä»¥ä¸‹å‘é›†ç¾¤ä¸­æ·»åŠ æ–°èŠ‚ç‚¹çš„æŒ‡ä»¤ï¼Œæˆ‘ä»¬è¿˜éœ€æ·»åŠ  <code>--cri-socket unix:///var/run/cri-dockerd.sock</code> é€‰é¡¹ã€‚è¿™æ ·ï¼Œæ–°èŠ‚ç‚¹å°±èƒ½ä¸ä¸»èŠ‚ç‚¹é€šä¿¡ï¼Œå®ŒæˆåŠ å…¥æµç¨‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">kubeadm <span class="hljs-built_in">join</span> 172.16.9.138:6443 --token 84neth.yfb5hv7dxwbj2kex --discovery-token-ca-cert-hash sha256:68636eeb5e226fdbf10d339f08f928a37b998df47efba8624b9560c8816fce26 <br></code></pre></td></tr></table></figure></li>
</ol>
<p><img src="/image/image_5BJCNIrBza.png" srcset="/img/loading.gif" lazyload alt="å›¾ 7ï¼šå·²æˆåŠŸå®‰è£…å¥½ä¸»èŠ‚ç‚¹å’Œå·¥ä½œèŠ‚ç‚¹" title="å›¾7ï¼šå·²æˆåŠŸå®‰è£…å¥½ä¸»èŠ‚ç‚¹å’Œå·¥ä½œèŠ‚ç‚¹"></p>
<h2 id="0x09-å‚è€ƒé“¾æ¥"><a href="#0x09-å‚è€ƒé“¾æ¥" class="headerlink" title="0x09 å‚è€ƒé“¾æ¥"></a>0x09 å‚è€ƒé“¾æ¥</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.kubesimplify.com/kubernetes-125-dockerd">Kubernetes 1.25 + Dockerd Set up Kubernetes on Ubuntu 22.04 with Dockerd as the container runtime</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/">Installing kubeadm å®˜æ–¹æ–‡æ¡£</a></li>
<li><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/">Docker å®˜æ–¹æ–‡æ¡£ - ä½¿ç”¨ apt ä»“åº“ å®‰è£… Docker</a></li>
</ul>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Kubernetes-%E5%AE%89%E5%85%A8/" class="print-no-link">#Kubernetes å®‰å…¨</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>åˆ›å»º Kubernetes 1.32+ é›†ç¾¤å¹¶ä½¿ç”¨ Docker ä½œä¸ºå®¹å™¨è¿è¡Œæ—¶</div>
      <div>http://example.com/2025/11/05/åˆ›å»º-Kubernetes-1-32-é›†ç¾¤å¹¶ä½¿ç”¨-Docker-ä½œä¸ºå®¹å™¨è¿è¡Œæ—¶/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>Yaney</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2025å¹´11æœˆ5æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/08/17/%E7%AC%AC-1-%E7%AB%A0-AWS-%E8%B4%A3%E4%BB%BB%E5%85%B1%E6%8B%85%E6%A8%A1%E5%9E%8B/" title="ç¬¬ 1 ç«  AWS è´£ä»»å…±æ‹…æ¨¡å‹">
                        <span class="hidden-mobile">ç¬¬ 1 ç«  AWS è´£ä»»å…±æ‹…æ¨¡å‹</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark-orange';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'y4ney/y4ney.github.io');
      s.setAttribute('issue-term', 'title');
      
      s.setAttribute('label', 'comment');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
